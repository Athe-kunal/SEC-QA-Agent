No sentence-transformers model found with name /home/athekunal/.cache/torch/sentence_transformers/ProsusAI_finbert. Creating a new one with MEAN pooling.
Some weights of the model checkpoint at /home/athekunal/.cache/torch/sentence_transformers/ProsusAI_finbert were not used when initializing BertModel: ['classifier.weight', 'classifier.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
[32mINFO[39m:     Started server process [[36m77093[39m]
[32mINFO[39m:     Waiting for application startup.
[32mINFO[39m:     Application startup complete.
[32mINFO[39m:     127.0.0.1:58244 - "[1mGET /docs HTTP/1.1[22m" [32m200 OK
[32mINFO[39m:     127.0.0.1:58244 - "[1mGET /openapi.json HTTP/1.1[22m" [32m200 OK
{'Section_Names': ['RISK_FACTORS'], 'Tickers': ['AAPL'], 'Years': ['2022'], 'user_query': 'What are the risk factors for Apple for the year 2022?'}
[32mINFO[39m:     127.0.0.1:58258 - "[1mGET /llm2/%7Bllm1_dict%7D?llm1_str=%7B%20%20%20%22Section_Names%22%3A%20%5B%20%20%20%20%20%22RISK_FACTORS%22%20%20%20%5D%2C%20%20%20%22Tickers%22%3A%20%5B%20%20%20%20%20%22AAPL%22%20%20%20%5D%2C%20%20%20%22Years%22%3A%20%5B%20%20%20%20%20%222022%22%20%20%20%5D%2C%20%20%20%22user_query%22%3A%20%22What%20are%20the%20risk%20factors%20for%20Apple%20for%20the%20year%202022%3F%22%20%7D HTTP/1.1[22m" [91m500 Internal Server Error
[31mERROR[39m:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/athekunal/.local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 435, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/home/athekunal/.local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
  File "/home/athekunal/.local/lib/python3.10/site-packages/fastapi/applications.py", line 282, in __call__
    await super().__call__(scope, receive, send)
  File "/home/athekunal/.local/lib/python3.10/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/athekunal/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/home/athekunal/.local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/home/athekunal/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/home/athekunal/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/home/athekunal/.local/lib/python3.10/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/home/athekunal/.local/lib/python3.10/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/home/athekunal/.local/lib/python3.10/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/home/athekunal/.local/lib/python3.10/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/home/athekunal/.local/lib/python3.10/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
  File "/home/athekunal/.local/lib/python3.10/site-packages/fastapi/routing.py", line 241, in app
    raw_response = await run_endpoint_function(
  File "/home/athekunal/.local/lib/python3.10/site-packages/fastapi/routing.py", line 167, in run_endpoint_function
    return await dependant.call(**values)
  File "/home/athekunal/SEC-Project/SEC-QA-Agent/fastapi_main.py", line 41, in LLM2
    relevant_dict = get_relevant_dict_with_mmr(llm1_output_dict,restore_collection,llm1_output_dict["user_query"],if_finbert=True)
  File "/home/athekunal/SEC-Project/SEC-QA-Agent/load_database.py", line 152, in get_relevant_dict_with_mmr
    query_results = restore_collection.query(
  File "/home/athekunal/.local/lib/python3.10/site-packages/chromadb/api/models/Collection.py", line 183, in query
    where = validate_where(where) if where else None
  File "/home/athekunal/.local/lib/python3.10/site-packages/chromadb/api/types.py", line 195, in validate_where
    raise ValueError(
ValueError: Expected where value for $and or $or to be a list with at least two where expressions, got [{'full_metadata': 'AAPL_2022_RISK_FACTORS_10-K'}]
[32mINFO[39m:     Shutting down
[32mINFO[39m:     Waiting for application shutdown.
[32mINFO[39m:     Application shutdown complete.
[32mINFO[39m:     Finished server process [[36m77093[39m]